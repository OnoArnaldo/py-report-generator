# pylint: disable=unused-variable
from pathlib import Path
from reportgen.report import Report
from ..utils import Ignore

ROOT_DIR = Path(__file__).parent
ASSETS_DIR = ROOT_DIR.joinpath('assets')


def assets(image):
    return ASSETS_DIR.joinpath(image)


def test_report(canvas):
    report = Report(name='report001', unit='cm', page_size='A4', font='Courier 10 left')
    page = report.new_page(name='page001', margin='1')

    row1 = page.new_row(name='header001', margin='0 0 0.5 0', height='5', border='0')
    col01 = row1.new_column(name='col001', width='15', border='1', margin='0 0 0 0.2')
    txt01 = col01.new_text(name='txt001', font='Courier 7 left', margin='0 0.1', value='Company name:')
    txt02 = col01.new_text(name='txt002', margin='0 1 0 0.2', value='Arnaldo Ono')

    col02 = row1.new_column(name='col002', border='1', margin='0 0.2 0 0')
    img01 = col02.new_image(name='img001', value=assets('150.png'))

    row2 = page.new_row(name='withLines', margin='0', height='5', border='1')
    ln01 = row2.new_line(name='continuous', margin='0.5', stroke='1')
    ln02 = row2.new_line(name='dashed', margin='1', stroke='1', dashes='3 6 1')

    row3 = page.new_row(name='barcode', margin='0', height='5', border='1')
    bar1 = row3.new_barcode(
        name='bc1', margin='0.5 1', code_set='128C', bar_width='0.1', align='center', value='1234567890'
    )
    report.process(canvas)

    canvas.save()

    assert object.__getattribute__(canvas, 'log') == [
        [
            'canvas/roundRect(..)',
            (28.346456692913385, 28.346456692913385, 425.1968503937008, 141.73228346456693, 5.0, 1),
            {},
        ],
        ['canvas/saveState(..)', (), {}],
        ['canvas/setFont', ('Courier', 7, None), {}],
        ['canvas._fontname = Courier'],
        ['canvas._fontsize = 7'],
        ['canvas/drawString(..)', (31.181102362204726, 35.346456692913385, 'Company name:'), {}],
        ['canvas/restoreState(..)', (), {}],
        ['canvas/saveState(..)', (), {}],
        ['canvas/setFont', ('Courier', 10, None), {}],
        ['canvas._fontname = Courier'],
        ['canvas._fontsize = 10'],
        ['canvas/drawString(..)', (56.69291338582677, 45.346456692913385, 'Arnaldo Ono'), {}],
        ['canvas/restoreState(..)', (), {}],
        [
            'canvas/roundRect(..)',
            (464.88188976377955, 28.346456692913385, 102.04724409448826, 141.73228346456693, 5.0, 1),
            {},
        ],
        [
            'canvas/drawImage(..)',
            (Ignore, 464.88188976377955, 28.346456692913385, 102.04724409448829, 141.73228346456693),
            {'preserveAspectRatio': True},
        ],
        [
            'canvas/roundRect(..)',
            (28.346456692913385, 184.251968503937, 538.5826771653544, 141.73228346456693, 5.0, 1),
            {},
        ],
        ['canvas/saveState(..)', (), {}],
        ['canvas/setDash(..)', ((),), {}],
        ['canvas/setLineWidth(..)', (1,), {}],
        ['canvas/line(..)', (42.519685039370074, 198.4251968503937, 552.7559055118111, 198.4251968503937), {}],
        ['canvas/restoreState(..)', (), {}],
        ['canvas/saveState(..)', (), {}],
        ['canvas/setDash(..)', ((3, 6, 1),), {}],
        ['canvas/setLineWidth(..)', (1,), {}],
        ['canvas/line(..)', (56.69291338582677, 241.9448818897638, 538.5826771653544, 241.9448818897638), {}],
        ['canvas/restoreState(..)', (), {}],
        [
            'canvas/roundRect(..)',
            (28.346456692913385, 325.98425196850394, 538.5826771653544, 141.73228346456693, 5.0, 1),
            {},
        ],
        [
            'canvas/rect(..)',
            (170.07874015748033, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (175.748031496063, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (178.58267716535434, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (181.4173228346457, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (187.08661417322836, 340.15748031496065, 8.503937007874017, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (195.59055118110237, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (201.25984251968504, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (204.09448818897638, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (206.92913385826773, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (212.5984251968504, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (218.26771653543307, 340.15748031496065, 8.503937007874017, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (226.77165354330708, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (232.44094488188975, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (235.2755905511811, 340.15748031496065, 8.503937007874017, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (243.7795275590551, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (246.61417322834646, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (249.4488188976378, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (255.11811023622047, 340.15748031496065, 8.503937007874017, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (263.6220472440945, 340.15748031496065, 8.503937007874017, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (272.12598425196853, 340.15748031496065, 8.503937007874017, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (280.62992125984255, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (283.46456692913387, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (286.2992125984252, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (291.9685039370079, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (294.8031496062992, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (300.4724409448819, 340.15748031496065, 11.338582677165356, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (311.81102362204723, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (314.64566929133855, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (317.48031496062987, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (320.3149606299212, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (325.9842519685039, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (331.6535433070866, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (334.4881889763779, 340.15748031496065, 11.338582677165356, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (345.82677165354323, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (348.66141732283455, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (354.33070866141725, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (357.16535433070857, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (359.9999999999999, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (365.6692913385826, 340.15748031496065, 11.338582677165356, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (377.0078740157479, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (382.6771653543306, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (385.51181102362193, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (388.34645669291325, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (394.01574803149595, 340.15748031496065, 8.503937007874017, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (402.51968503936996, 340.15748031496065, 8.503937007874017, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (411.023622047244, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (413.8582677165353, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (416.6929133858266, 340.15748031496065, 2.834645669291339, 113.38582677165354),
            {'fill': 0, 'stroke': 0},
        ],
        [
            'canvas/rect(..)',
            (419.52755905511793, 340.15748031496065, 5.669291338582678, 113.38582677165354),
            {'fill': 1, 'stroke': 0},
        ],
        ['canvas/showPage(..)', (), {}],
        ['canvas/save(..)', (), {}],
    ]
